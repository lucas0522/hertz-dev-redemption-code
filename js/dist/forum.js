(()=>{var o={n:t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},d:(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o:(o,t)=>Object.prototype.hasOwnProperty.call(o,t)};(()=>{"use strict";const t=flarum.core.compat["forum/app"];var e=o.n(t);const n=flarum.core.compat["common/extend"],r=flarum.core.compat["forum/utils/UserControls"];var a=o.n(r);const c=flarum.core.compat["common/components/Button"];var i=o.n(c);function s(o,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,t){return o.__proto__=t,o},s(o,t)}const u=flarum.core.compat["common/components/Modal"];var l=o.n(u);const d=flarum.core.compat["common/utils/Stream"];var p=o.n(d),f=function(o){function t(){return o.apply(this,arguments)||this}var n,r;r=o,(n=t).prototype=Object.create(r.prototype),n.prototype.constructor=n,s(n,r);var a=t.prototype;return a.oninit=function(t){o.prototype.oninit.call(this,t),this.code=p()("")},a.className=function(){return"RedeemModal Modal--small"},a.title=function(){return"使用兑换码"},a.content=function(){var o=this;return m("div",{className:"Modal-body"},m("div",{className:"Form-group"},m("label",null,"请输入您的兑换码"),m("input",{className:"FormControl",placeholder:"例如: VIP-XXXX-XXXX",value:this.code(),oninput:function(t){return o.code(t.target.value)}})),m("div",{className:"Form-group"},i().component({type:"submit",className:"Button Button--primary",loading:this.loading,disabled:!this.code()},"立即兑换")))},a.onsubmit=function(o){var t=this;o.preventDefault(),this.loading=!0,e().request({method:"POST",url:e().forum.attribute("apiUrl")+"/redemption/redeem",body:{code:this.code()}}).then(function(){t.hide(),e().alerts.show({type:"success"},"兑换成功！您的有效期已延长。"),window.location.reload()}).catch(function(o){t.loading=!1,m.redraw()})},t}(l());e().initializers.add("hertz-dev-redemption-code",function(){(0,n.extend)(a(),"userControls",function(o,t){e().session.user&&e().session.user===t&&o.add("redeem",i().component({icon:"fas fa-ticket-alt",onclick:function(){return e().modal.show(f)}},"使用兑换码"))})})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map